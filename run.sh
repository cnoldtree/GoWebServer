#!/bin/bash

if [ "$1" = "build" ]
then
    go get -u
    go fmt
    go build
fi

if [ "$1" = "test" ]
then
    if [ -n "$2" ]
    then
        cmd="go test -timeout 99999s -run $2"
    else
        cmd="go test -timeout 99999s"
    fi
else
    cmd="./marketx-server"
fi

MX_SERVER_DOMAIN="https://127.0.0.1:8443" MX_SERVER_P_PORT=8080 MX_SERVER_PORT=8443 DATABASE_URL='postgres://user:password@localhost/marketx?sslmode=disable' MX_JWT_SECRET_KEY='1111111111111111111111111111111111111111111111111111111111111111' MX_AES_TEXT_KEY='1111111111111111111111111111111111111111111111111111111111111111' MX_AES_FILE_KEY='1111111111111111111111111111111111111111111111111111111111111111' MX_SUPPORT_EMAIL='' MX_SUPPORT_EMAIL_PASSWORD='' MX_TRANSACT_URL='' MX_TRANSACT_ID='' MX_TRANSACT_KEY='' MX_CLIENT_DIR='' MX_DOCUSIGN_USERNAME='' MX_DOCUSIGN_PASSWORD='' MX_DOCUSIGN_ACCOUNT_ID='' MX_DOCUSIGN_INTEGRATOR_KEY='' MX_WECHAT_TOKENS='' ${cmd}
